<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Const Generics Project Group</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="skill-tree.css">
        <link rel="stylesheet" href="skill-tree-finetuning.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html">👋🏽 Welcome</a></li><li class="chapter-item expanded "><a href="CHARTER.html">📜 Charter</a></li><li class="chapter-item expanded "><a href="vision.html">🔮 The vision</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vision/characters.html">🙋‍♀️ Cast of characters</a></li><li class="chapter-item expanded "><a href="skill-tree.html">🔀 Skill Tree</a></li><li class="chapter-item expanded "><a href="vision/status_quo.html">😱 Status quo</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vision/status_quo/array_default.html">Array defaults</a></li><li class="chapter-item expanded "><a href="vision/status_quo/split_first.html">Array split first method</a></li></ol></li><li class="chapter-item expanded "><a href="vision/shiny_future.html">✨ Shiny future</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="vision/shiny_future/array_default.html">Array defaults</a></li><li class="chapter-item expanded "><a href="vision/shiny_future/split_first.html">Array split first method</a></li><li class="chapter-item expanded "><a href="vision/shiny_future/image_type.html">Image type in rust-gpu</a></li></ol></li><li class="chapter-item expanded "><a href="vision/roadmap.html">📅 Roadmap for 2021</a></li><li class="chapter-item expanded "><a href="vision/how_to_vision_doc.html">❓How to vision doc</a></li></ol></li><li class="chapter-item expanded "><a href="draft-rfcs/index.html">✏️ Draft RFCs</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Const Generics Project Group</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/project-const-generics" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="-const-generics-project-group"><a class="header" href="#-const-generics-project-group">👋🏽 Const Generics Project Group</a></h1>
<!--
 Status badge advertising the project as being actively worked on. When the
 project has finished be sure to replace the active badge with a badge
 like: https://img.shields.io/badge/status-archived-grey.svg
-->
<p><img src="https://img.shields.io/badge/status-active-brightgreen.svg" alt="project group status: active" /></p>
<!--
FIXME(website)
[![project group documentation](https://img.shields.io/badge/MDBook-View%20Documentation-blue)][gh-pages]
-->
<p>The const generics project group implements and designs the <code>const_generics</code> feature. Please refer to our <a href="./CHARTER.html">charter</a> for more information on our goals and current scope.</p>
<p>Examples:</p>
<pre><pre class="playground"><code class="language-rust">struct Foo&lt;const N: usize&gt; {
    field: [u8; N],
}

fn foo&lt;const N: usize&gt;() -&gt; Foo&lt;N&gt; {
    Foo {
        field: [0; N],
    }
}

fn main() {
    match foo::&lt;3&gt;().field {
        [0, 0, 0] =&gt; {} // ok
        [_x, _y, _z] =&gt; panic!(),
    }
}
</code></pre></pre>
<p>Welcome to the repository for the Const Generics Project Group! This is the
repository we use to organise our work. Please refer to our <a href="./CHARTER.html">charter</a> as well
as our <a href="https://rust-lang.github.io/project-const-generics">github pages website</a> for more information on our goals and
current scope.</p>
<h2 id="how-can-i-get-involved"><a class="header" href="#how-can-i-get-involved">How Can I Get Involved?</a></h2>
<p><a href="https://github.com/rust-lang/team/blob/master/teams/project-const-generics.toml">You can find a list of the current members available
on <code>rust-lang/team</code>.</a></p>
<p>If you'd like to participate be sure to check out the relevant stream on <a href="https://rust-lang.zulipchat.com/#narrow/stream/260443-project-const-generics">zulip</a>, feel free to introduce
yourself over there and ask us any questions you have.</p>
<h2 id="building-documentation"><a class="header" href="#building-documentation">Building Documentation</a></h2>
<p>This repository is also an mdbook project. You can view and build it using the
following command.</p>
<pre><code>mdbook serve
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="--const-generics-charter"><a class="header" href="#--const-generics-charter">📜  Const Generics Charter</a></h1>
<p>The goal of this group is to both improve and extend the support for const generics.</p>
<h2 id="goals"><a class="header" href="#goals">Goals</a></h2>
<p>Improving the user experience when using and working on const generics. This includes both improvements to diagnostics for the already stabilized parts as well as adding new features:</p>
<ul>
<li>const param defaults <code>struct Foo&lt;const N: usize = 3&gt;</code></li>
<li>more const param types, most importantly user defined types and <code>&amp;'static str</code></li>
<li>allowing complex generic operations in constants</li>
</ul>
<h2 id="constraints-and-considerations"><a class="header" href="#constraints-and-considerations">Constraints And Considerations</a></h2>
<p>At least for the near future, we will mostly focus on the items mentioned above.</p>
<!-- Why not just do everything, it's not like burnout is a problem in open source -->
<div style="break-before: page; page-break-before: always;"></div><h1 id="-the-vision"><a class="header" href="#-the-vision">🔮 The vision</a></h1>
<h2 id="what-is-this"><a class="header" href="#what-is-this">What is this</a></h2>
<p>This section lays out a general vision and set of goals for Const Generics in Rust. </p>
<h2 id="status-and-schedule"><a class="header" href="#status-and-schedule">Status and schedule</a></h2>
<p><strong>This document is currently being formed.</strong> </p>
<h2 id="this-is-a-group-effort"><a class="header" href="#this-is-a-group-effort">This is a group effort</a></h2>
<p>As the leads of the Const Generics group, Niko and Lcnr are driving and organizing this document. But writing it and shaping it is a group effort. If you think there is a part of the const generics experience that is not reflected here, we want to hear from you! Check out the <a href="./vision/how_to_vision_doc.html">How to vision doc</a> for more details on how to contribute.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-cast-of-characters"><a class="header" href="#-cast-of-characters">🙋‍♀️ Cast of characters</a></h1>
<h2 id="what-is-this-1"><a class="header" href="#what-is-this-1">What is this?</a></h2>
<p>We've created four characters that we use to guide our thinking. These characters are the protagonists of our <a href="vision/./status_quo.html">status quo</a> and <a href="vision/./shiny_future.html">shiny future</a> stories, and they help us to think about the different kinds of priorities and expectations that people bring when using Const Generics in rust. Having names and personalities also makes the stories more fun and approachable.</p>
<h2 id="the-characters"><a class="header" href="#the-characters">The characters</a></h2>
<ul>
<li>Alan: the experienced &quot;GC'd language&quot; developer, new to Rust
<ul>
<li><em>Top priority</em>: performance -- that's what he is not getting from current GC'd language</li>
<li><em>Expectations</em>: absence of memory safety bugs (he gets that now from his GC), strong ecosystem, great tooling</li>
</ul>
</li>
<li>Grace: the systems programming expert, new to Rust
<ul>
<li><em>Top priority</em>: memory safety -- that's what she is not getting from C/C++</li>
<li><em>Expectations</em>: able to do all the things she's used to from C/C++</li>
</ul>
</li>
<li>Niklaus: new programmer from an unconventional background
<ul>
<li><em>Top priority</em>: accessibility -- he's learning a lot of new things at once</li>
<li><em>Expectations</em>: community -- the community enabled him to have early success, and he is excited to have it support him and him grow more</li>
</ul>
</li>
<li>Barbara: the experienced Rust developer
<ul>
<li><em>Top priority</em>: overall productivity and long-term maintenance -- she loves Rust, and wants to see it extended to new areas; she has an existing code base to maintain</li>
<li><em>Expectations</em>: elegance and craftsmanship, fits well with Rust</li>
</ul>
</li>
</ul>
<h2 id="-frequently-asked-questions"><a class="header" href="#-frequently-asked-questions">🤔 Frequently Asked Questions</a></h2>
<h3 id="where-do-the-names-come-from"><a class="header" href="#where-do-the-names-come-from">Where do the names come from?</a></h3>
<p>Famous programming language designers and theorists. <a href="https://en.wikipedia.org/wiki/Alan_Turing">Alan Turing</a>, <a href="https://en.wikipedia.org/wiki/Grace_Hopper">Grace Hopper</a>, <a href="https://en.wikipedia.org/wiki/Niklaus_Wirth">Niklaus Wirth</a>, and <a href="https://en.wikipedia.org/wiki/Barbara_Liskov">Barbara Liskov</a>.</p>
<h3 id="i-dont-see-myself-in-these-characters-what-should-i-do"><a class="header" href="#i-dont-see-myself-in-these-characters-what-should-i-do">I don't see myself in these characters. What should I do?</a></h3>
<p>Come to Zulip (#project-const-generics) and talk to us about it! Maybe they need to be adjusted!</p>
<h3 id="i-see-myself-in-more-than-one-of-these-characters"><a class="header" href="#i-see-myself-in-more-than-one-of-these-characters">I see myself in more than one of these characters!</a></h3>
<p>Yeah, me too.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="skill-tree-for-const-generics-features"><a class="header" href="#skill-tree-for-const-generics-features">Skill tree for const generics features</a></h1>
<div id='skill-tree-0'></div>
<script>
                    if (!window.SKILL_TREES) window.SKILL_TREES = [];
                    window.SKILL_TREES.push({id:'skill-tree-0', value:{"dot_text":"digraph g {\ngraph [ rankdir = \"LR\" ];\nnode [ fontsize=\"16\", shape = \"ellipse\" ];\nedge [ ];\n\"min_cg\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\" href=\"https://github.com/rust-lang/rust/pull/79135\">MIN CONST GENERICS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\" href=\"https://github.com/rust-lang/rust/pull/79135\">Minimum subset of const generics only allowing `const N: {integer} | bool | char` and fully concrete constants</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"valtree\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">VALTREES</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Use valtrees in all type level constants</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Design of structural equality is worked out</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Valtrees are implemented</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"min_defaults\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">CONCRETE CONST DEFAULTS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Permit concrete defaults on traits/adts</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"generic_defaults\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">GENERIC CONST DEFAULTS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Permit generic defaults on traits/adts</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Disallow usage of forward declared params via param env</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Decide when a generic default is considered well formed</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"param_tys\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">MORE CONST PARAM TYPES</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Permit more types to be as the type of a const generic</td></tr>\n    <tr><td bgcolor=\"cornsilk\">A `Constable` that that signifies a type is valid to use as a const param type</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Generic const param types i.e. `T: Constable, const N: T`</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Consider `impl&lt;const N: usize&gt; Trait&lt;{ Some(N) }&gt; for ()` to constrain `N`</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"exhaustiveness\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">IMPL EXHAUSTIVENESS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Allow separate impls to be used to fulfill `for&lt;const N: usize&gt; (): Trait&lt;N&gt;`</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"min_generic_consts\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">MIN GENERIC CONSTANTS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Allow type level constants to be generic i.e. `N + 1`</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Add a where clause that requires a given expression to be evaluatable e.g. `where evaluatable { N - 1 }`</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Unused substs make it hard to tell if a const is concrete or generic and breaks unsize coercion in some cases</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Don't eagerly error when evaluating constants during selection</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"generic_consts\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">GENERIC CONSTANTS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Allow type level constants but better ✨</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Allow writing a where clause that requires a condition to hold e.g. `where { N &gt; 2 }`</td></tr>\n    <tr><td bgcolor=\"cornsilk\">Some things can always evaluate and should not need a where clause e.g. `{ N == M }` `{ N / 1 }`</td></tr>\n    <tr><td bgcolor=\"cornsilk\">If possible `where { N &gt; 0 }` should imply `N - 1` is evaluatable</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"assoc_const_bounds\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\">ASSOCIATED CONST BOUNDS</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\">Permit where `where T: Trait&lt;ASSOC = 10&gt;`</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"arg_infer\" [\n  label = <<table>\n    <tr><td bgcolor=\"darkgoldenrod\" colspan=\"1\" href=\"https://github.com/rust-lang/rust/pull/83484\">GENERIC ARG CONST INFER</td></tr>\n    <tr><td bgcolor=\"darkgoldenrod1\" colspan=\"1\" href=\"https://github.com/rust-lang/rust/pull/83484\">Permit using `_` for generic args</td></tr>\n  </table>>\n  shape = \"none\"\n  margin = 0\n]\n\"min_cg\" -> \"min_defaults\";\n\"min_defaults\" -> \"generic_defaults\";\n\"valtree\" -> \"param_tys\";\n\"min_cg\" -> \"param_tys\";\n\"param_tys\" -> \"exhaustiveness\";\n\"min_cg\" -> \"min_generic_consts\";\n\"min_generic_consts\" -> \"generic_consts\";\n\"min_generic_consts\" -> \"assoc_const_bounds\";\n\"min_cg\" -> \"arg_infer\";\n}\n","error":""}});
                    </script><div style="break-before: page; page-break-before: always;"></div><h1 id="-status-quo-stories"><a class="header" href="#-status-quo-stories">😱 Status quo stories</a></h1>
<h2 id="what-is-this-2"><a class="header" href="#what-is-this-2">What is this</a></h2>
<p>The &quot;status quo&quot; stores are here to state our &quot;theory of the case&quot;. That is, they present (and prove) our hypotheses as to what the various challenges are for users of Const Generics in Rust. These hypotheses are presented in narrative form, by telling the story of a specific <a href="vision/./characters.html">character</a> as they try (and typically fail in dramatic fashion) to achieve their goals.</p>
<h3 id="based-on-a-true-story"><a class="header" href="#based-on-a-true-story">Based on a true story</a></h3>
<p>These stories are not made up. They are always based on real-life experiences of actual people. Each story contains a &quot;Frequently Asked Questions&quot; section, and that will include notes the sources used to create the story. In some cases, it may link to notes or summaries in the <a href="vision/../conversations.html">conversations</a> section, though that is not required. The &quot;Frequently Asked Questions&quot; section also contains a summary of what the &quot;morals&quot; of the story are (i.e., what are the key takeaways), along with answers to questions that people have raised along the way.</p>
<h3 id="the-stories-provide-data-we-use-to-prioritize-not-a-prioritization-itself"><a class="header" href="#the-stories-provide-data-we-use-to-prioritize-not-a-prioritization-itself">The stories provide data we use to prioritize, not a prioritization itself</a></h3>
<p><strong>Just because a user story is represented here doesn't mean we're going to be able to fix it right now.</strong> Some of these user stories will indicate more severe problems than others. As we consider the stories, we'll select some subset to try and address; that choice is reflected in the <a href="vision/./roadmap.html">roadmap</a>.</p>
<h3 id="help-wanted"><a class="header" href="#help-wanted">Help wanted!</a></h3>
<p>This is not a static document! There are lots of ways you can help to expand it! Take a look at the <a href="vision/./how_to_vision_doc.html">How to Vision Doc</a> for more details.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-status-quo-story-barbara-wants-to-implement-default-for-all-array-lengths"><a class="header" href="#-status-quo-story-barbara-wants-to-implement-default-for-all-array-lengths">😱 Status quo story: Barbara wants to implement <code>Default</code> for all array lengths</a></h1>
<p>Barbara is working on <code>std</code>. She wants to implement <code>Default</code> for all array types. Currently, it is implemented for <code>N &lt;= 32</code> using a macro (<a href="https://doc.rust-lang.org/nightly/src/core/array/mod.rs.html#391">link</a>)</p>
<p>She thinks &quot;Ah, I can use min-const-generics for this!&quot; and goes to write</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T, const N: usize&gt; Default for [T; N]
where
    T: Default,
{
    fn default() -&gt; Self {
        
    }

}
<span class="boring">}
</span></code></pre></pre>
<p>So far so good, but then she realizes she can't figure out what to write in the body. At first she tries:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T, const N: usize&gt; Default for [T; N]
where
    T: Default,
{
    fn default() -&gt; Self {
        [T::default(); N]
    }

}
<span class="boring">}
</span></code></pre></pre>
<p>but this won't compile:</p>
<pre><code>error[E0277]: the trait bound `T: Copy` is not satisfied
  --&gt; src/lib.rs:10:9
   |
10 |         [T::default(); N]
   |         ^^^^^^^^^^^^^^^^^ the trait `Copy` is not implemented for `T`
   |
   = note: the `Copy` trait is required because the repeated element will be copied
help: consider further restricting this bound
   |
7  |     T: MyDefault + Copy,
   |                  ^^^^^^
</code></pre>
<p>&quot;Ah,&quot; she realizes, &quot;this would be cloning a single value of <code>T</code>, but I want to make <code>N</code> distinct values. How can I do that?&quot;</p>
<p>She asks on Zulip and lcnr tells her that there is this <a href="https://doc.rust-lang.org/std/primitive.array.html#method.map"><code>map</code> function  defined on arrays</a>. She could write:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T, const N: usize&gt; Default for [T; N]
where
    T: Default,
{
    fn default() -&gt; Self {
        [(); N].map(|()| T::default())
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>&quot;That code will build,&quot; lcnr warns her, &quot;but we're not going to be able to ship it. Test it and see.&quot; Barbara runs the tests and finds she is getting a failure. The following test no longer builds:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn generic&lt;T&gt;() -&gt; [T; 0] {
    Default::default()
}
<span class="boring">}
</span></code></pre></pre>
<p>&quot;Ah,&quot; she says, &quot;I see that <code>Default</code> is implemented for any type <code>[T; 0]</code>, regardless of whether <code>T: Default</code>. That makes sense. Argh!&quot;</p>
<p>Next she tries (this already relies on a nightly feature)</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T: Trait, const N: usize&gt; Default for [T; N]
where
    T: Default,
    N != 0, // nightly feature!
{
    fn default() -&gt; Self {
        [(); N].map(|()| T::default())
    }
}

impl&lt;T&gt; Trait for [T; 0] {
    // ...
}
<span class="boring">}
</span></code></pre></pre>
<p>While this does seem to compile, when trying to use it, it causes an unexpected error.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn foo&lt;T: Trait, const N: usize&gt;() -&gt; [u8; N] {
    &lt;[T; N] as Trait&gt;::ASSOC //~ ERROR `[T; N]` does not implement `Trait`
}
<span class="boring">}
</span></code></pre></pre>
<p>The compiler can't tell that <code>N == 0 || N != 0</code> is true for all possible <code>N</code>, so it can't infer <code>[T; N]: Trait</code> from <code>T: Trait</code>.</p>
<p>Frustrated, Barbara gives up and goes looking for another issue to fix.</p>
<p>Even worse, Barbara notices the same problem for <code>serde::Deserialize</code> and decides to
abandon backwards compatibility in favor of a brighter future.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-status-quo-array-split-first-method"><a class="header" href="#-status-quo-array-split-first-method">😱 Status quo: Array split first method</a></h1>
<p>Barbara is working on her project. She has the idea to write a <code>split_first</code> function that will allow her to split out the first item from a fixed-length array; naturally, the array must be non-empty. It looks something like this:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Note: this method has an implied where clause that `N - 1` evaluates without 
// erroring because `N - 1` is in the function signature
fn split_first&lt;T, const N: usize&gt;(arr: [T; N]) -&gt; (T; [T; N - 1]) {
    // ...
    let tail: [T; N - 1] = // ...
    (head, tail)
}
<span class="boring">}
</span></code></pre></pre>
<p>Next she wants to write a function that uses <code>split_first</code>:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_method&lt;const N: usize&gt;(arr: [u8; N]) {
    let (first, rest) = split_first(arr);
    for i in rest {
        // ...
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>The compiler gives her a compile error:</p>
<pre><code>error: the constant expression `N-1` is not known to be evaluatable
2 |     let (first, rest) = split_first(arr);
  |                         ^^^^^^^^^^^ `N-1` not known to be evaluatable
info: N may underflow
help: add a where clause to `some_method`
  | fn some_method&lt;const N: usize&gt;(arr: [u8; N]) where [(); {N - 1}]:
</code></pre>
<p>Barbara hits the 'quick fix' button in her IDE and it inserts the where clause for her- she immediately
gets a compile error at another spot because she was calling <code>some_method</code> with an empty array:</p>
<pre><code>error: integer underflow evaluating constant expression
22 |     some_method([])
   |     ^^^^^^^^^^^^^^^ `0-1` is not evaluatable
info: `0-1` must be evaluatable because of this where clause
  | fn some_method&lt;const N: usize&gt;(arr: [u8; N]) where [(); { N - 1}]:
  |                                                    ---------------
</code></pre>
<p>She also gets a compile error at another spot with a <code>[(); { N - 2; }]:</code> where clause in scope</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_other_method&lt;const N: usize&gt;(arr: [u8; N]) where [(); { N - 2; }]: {
    // ...
    let (first, rest) = split_first(arr);
    // ...
}
<span class="boring">}
</span></code></pre></pre>
<pre><code>error: the constant expression `N-1` is not known to be evaluatable
2 |     let (first, rest) = split_first(arr);
  |                         ^^^^^^^^^^^ `N-1` not known to be evaluatable
info: N may underflow
help: add a where clause to `some_method`
  | fn some_method&lt;const N: usize&gt;(arr: [u8; N]) where [(); { N - 2; }}:, [(); { N - 1; }];, {
</code></pre>
<p>&quot;What!!! That's silly&quot;- Barbara sighs, hitting the quick fix button and moving on</p>
<p>(rustc is not currently smart enough to know that <code>N - 2</code> being evaluatable implies <code>N - 1</code>)</p>
<h2 id="alt-universe-with-post-mono-errors"><a class="header" href="#alt-universe-with-post-mono-errors">Alt Universe with post-mono errors</a></h2>
<p>Barbara is working on her project. She has the idea to write a <code>split_first</code> function that will allow her to split out the first item from a fixed-length array; naturally, the array must be non-empty. It looks something like this:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Note: this method has no implied where clause that `N - 1` evaluates
fn split_first&lt;T, const N: usize&gt;(arr: [T; N]) -&gt; (T; [T; N - 1]) {
    // ...
    let tail: [T; N - 1] = // ...
    (head, tail)
}
<span class="boring">}
</span></code></pre></pre>
<p>Next she wants to write a function that uses <code>split_first</code>:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_method&lt;const N: usize&gt;(arr: [u8; N]) {
    let (first, rest) = split_first(arr);
    for i in rest {
        // ...
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Everything seems fine when she runs <code>cargo check</code>. Then later she runs <code>cargo test</code> and sees a compilation error:</p>
<pre><code>error: const evaluation error occurred
22 |    let tail: [T; N - 1] = // ...
   |                  ^^^^^ integer underflow, cannot subtract `1` from `0`
info: this const evaluation was required by `some_other_method`, which contains:
22 |     some_method([])
info: `some_method` contains:
22 |    let (first, rest) = split_first(arr);
info: `split_first` contains:
22 |    let tail: [T; N - 1] = // ...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-shiny-future-where-we-want-to-get-to"><a class="header" href="#-shiny-future-where-we-want-to-get-to">✨ Shiny future: Where we want to get to</a></h1>
<p>The &quot;shiny future&quot; is here to tell you what we are trying to build over the next 2-3 years. That is, it presents our &quot;best guess&quot; as to what will look like a few years from now. When describing specific features, it also embeds links to <a href="vision/../design_notes.html">design notes</a> that describe the constraints and general plans around that feature.</p>
<p>Predicting the future is a tricky business! Many of the things described in the &quot;shiny future&quot; doc have a lot of uncertainty. We fully expect that the designs and narratives described in this document will change as we work towards realizing them. When there are areas of particular uncertainty, we use the Frequently Asked Questions and the design docs to call them out.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-shiny-future-story-barbara-implements-default-for-all-array-lengths"><a class="header" href="#-shiny-future-story-barbara-implements-default-for-all-array-lengths">✨ Shiny future story: Barbara implements <code>Default</code> for all array lengths</a></h1>
<p>Shiny future of <a href="vision/shiny_future/../status_quo/array_default.html">status quo story</a></p>
<p>Barbara is working on <code>std</code>. She saw that the newest version of rustc has had some improvements to const generics
and decides to try implementing <code>Default</code> for all array lengths. She goes to write:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T, const N: usize&gt; Default for [T; N]
where
    T: Default,
{
    fn default() -&gt; Self {
        /* snip */
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>The code builds just fine but then she sees a test failing:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn generic&lt;T&gt;() -&gt; [T; 0] {
    Default::default()
}
<span class="boring">}
</span></code></pre></pre>
<p>&quot;Ah,&quot; she says, &quot;I see that Default is implemented for any type [T; 0], regardless of whether T: Default. That makes sense. Argh!&quot;</p>
<p>Next she tries to write:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;T, const N: usize&gt; Default for [T; N]
where
    T: Default,
    { N &gt; 0 },
{
    fn default() -&gt; Self {
        /* snip */
    }
}

impl&lt;T&gt; Default for [T; 0] {
    fn default() -&gt; Self {
        []
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>This compiles just fine and the test is passing. She decides to submit a PR where her reviewer asks her to 
add a test to make sure that <code>[T; N]: Default</code> holds when <code>T: Default</code> as this didn't used to work</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn exhaustive_default_impl&lt;T: Default, const N: usize&gt;() -&gt; [T; N] {
    &lt;[T; N] as Default&gt;::default()
}
<span class="boring">}
</span></code></pre></pre>
<p>This test passes just fine, &quot;yay const generics ✨&quot; she says</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-shiny-future-story-array-split-first-method"><a class="header" href="#-shiny-future-story-array-split-first-method">✨ Shiny future story: Array split first method</a></h1>
<p>Shiny future of <a href="vision/shiny_future/../status_quo/split_first.html">status quo story</a></p>
<p>Barbara is working on her project. She has the idea to write a <code>split_first</code> function that will allow her to split out the first item from a fixed-length array; naturally, the array must be non-empty. It looks something like this:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Note: this method has an implied where clause that `N - 1` evaluates without 
// erroring because `N - 1` is in the function signature
fn split_first&lt;T, const N: usize&gt;(arr: [T; N]) -&gt; (T; [T; N - 1]) {
    // ...
    let tail: [T; N - 1] = // ...
    (head, tail)
}
<span class="boring">}
</span></code></pre></pre>
<p>Next she wants to write a function that uses <code>split_first</code>:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_method&lt;const N: usize&gt;(arr: [u8; N]) {
    let (first, rest) = split_first(arr);
    for i in rest {
        // ...
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>The compiler gives her a compile error:</p>
<pre><code>error: the constant expression `N - 1` is not known to evaluate without underflowing
2 |     let (first, rest) = split_first(arr);
  |                         ^^^^^^^^^^^ `N - 1` not known to be evaluatable without underflowing
note: required by this expression in `split_first`'s function signature
5 |     fn split_first&lt;T, const N: usize&gt;(arr: [T; N]) -&gt; (T; [T; N - 1]) {
  |                                                               ^^^^^
help: add a where clause to `some_method`
  | fn some_method&lt;const N: usize&gt;(arr: [u8; N]) where { N &gt; 0; }
</code></pre>
<p>Barbara hits the 'quick fix' button in her IDE and it inserts the where clause for her- she immediately
gets a compile error at another spot because she was calling <code>some_method</code> with an empty array:</p>
<pre><code>error: the constant `0` is not greater than `0`
22 |     some_method([])
info: `0` must be greater than `0` because of this where clause
  | fn some_method&lt;const N: usize&gt;(arr: [u8; N]) where { N &gt; 0; }
  |                                                    ----------
</code></pre>
<p>Barbara has no more compile errors, even the following code is compiling:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_other_method&lt;const N: usize&gt;(arr: [u8; N]) where { N &gt; 1; } {
    // ...
    let (first, rest) = split_first(arr);
    // ...
}
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-shiny-future-story-image-type-in-rust-gpu"><a class="header" href="#-shiny-future-story-image-type-in-rust-gpu">✨ Shiny future story: Image type in rust-gpu</a></h1>
<p>Barbara is working on rust-gpu. In that project, she has a struct <code>Image</code> that represents GPU images. There are a number of constant parameters allowing this type to be heavily customized in a number of ways. In some cases, helper methods are only available for images with particular formats. She writes the struct declaration:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Image&lt;
    SampledType: SampleType&lt;FORMAT&gt;,
    const DIM: Dimensionality,
    const DEPTH: ImageDepth,
    const ARRAYED: Arrayed,
    const MULTISAMPLED: Multisampled,
    const SAMPLED: Sampled,
    const FORMAT: ImageFormat,
    const ACCESS_QUALIFIER: Option&lt;AccessQualifier&gt;,
&gt;(PhantomData&lt;SampledType&gt;);
<span class="boring">}
</span></code></pre></pre>
<p>Barbara gets a few compile errors about her types used as a const param not implementing <code>StructuralEq</code> so she derives that and moves on.
She then wants to write some methods that only work for images in some specific formats:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;
    SampledType: SampleType&lt;FORMAT&gt;,
    const DIM: Dimensionality,
    const DEPTH: ImageDepth,
    const ARRAYED: Arrayed,
    const MULTISAMPLED: Multisampled,
    const SAMPLED: Sampled,
    const FORMAT: ImageFormat,
    const ACCESS_QUALIFIER: Option&lt;AccessQualifier&gt;,
&gt; Image&lt;SampledType, DIM, DEPTH, ARRAYED, MULTISAMPLED, SAMPLED, FORMAT, ACCESS_QUALIFIER&gt; {
    pub fn example_method(/* snip */)
    where
        { some_condition(DEPTH, MULTISAMPLED) }
    { /* snip */ }
}

const fn some_condition(a: ImageDepth, m: Multisampled) -&gt; bool {
    match (a, m) {
        /* snip */
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>This compiles just fine and Barbara moves on to more complicated things </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-the-roadmap-what-were-doing-in-2021"><a class="header" href="#-the-roadmap-what-were-doing-in-2021">📅 The roadmap: what we're doing in 2021</a></h1>
<p>This page describes the current plans for 2021.
It is updated on a monthly basis.</p>
<h2 id="key"><a class="header" href="#key">Key</a></h2>
<table><thead><tr><th>Emoji</th><th>Meaning</th></tr></thead><tbody>
<tr><td>🥬</td><td>&quot;Healthy&quot; -- on track with the plan as described in the doc</td></tr>
<tr><td>✏️</td><td>&quot;Planning&quot; -- Still figuring out the plan</td></tr>
<tr><td>🤒</td><td>&quot;Worried&quot; -- things are looking a bit tricky, plans aren't working out</td></tr>
<tr><td>🏖️</td><td>&quot;On vacation&quot; -- taking a break right now</td></tr>
<tr><td>⚰️</td><td>We gave up on this idea =)</td></tr>
</tbody></table>
<h2 id="roadmap-items"><a class="header" href="#roadmap-items">Roadmap items</a></h2>
<table><thead><tr><th>Plan</th><th>Owner</th><th>Status</th><th>Last updated</th></tr></thead><tbody>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-how-to-vision-doc"><a class="header" href="#-how-to-vision-doc">❓ How to vision doc</a></h1>
<p>This page describes the process for contributing to the vision doc.</p>
<h2 id="who-owns-this-document"><a class="header" href="#who-owns-this-document">Who owns this document?</a></h2>
<p>This document is owned and maintained by the leads of the project-const-generics group.
They decide what content to accept or reject. 
This decision is made in consultation with the Rust teams that will be making the ultimate decisions. 
For example, if a design doc or part of the shiny future is describing a new language feature, the leads ought to  discuss that with the language design team, since that team will ultimately have to approve the RFCs for its design.</p>
<h2 id="how-to-participate"><a class="header" href="#how-to-participate">How to participate</a></h2>
<p>For now, you have to join our weekly meetings.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="-rfc-drafts"><a class="header" href="#-rfc-drafts">✏️ RFC drafts</a></h1>
<p>This folder contains drafts of RFCs that the group is preparing to submit.</p>
<!--
Once the group has submitted RFCs, the drafts should be deleted from this folder,
and links to the pull requests on the RFC repository should be listed here.
-->

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="viz.js"></script>
        <script type="text/javascript" src="panzoom.min.js"></script>
        <script type="text/javascript" src="full.render.js"></script>
        <script type="text/javascript" src="skill-tree.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
